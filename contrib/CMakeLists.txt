if (CLICKHOUSE_ODBC_TEST)
    add_subdirectory (gtest)

    if (USE_INTERNAL_NANOODBC_LIBRARY)
        set (NANODBC_DISABLE_EXAMPLES 1 CACHE INTERNAL "")
        set (NANODBC_DISABLE_LIBCXX 1 CACHE INTERNAL "")
        set (NANODBC_DISABLE_TESTS 1 CACHE INTERNAL "")
        set (NANODBC_DISABLE_INSTALL 1 CACHE INTERNAL "")
        set (NANODBC_ENABLE_UNICODE 0 CACHE INTERNAL "")
        add_subdirectory (nanodbc)
        set_target_properties(${NANOODBC_LIBRARY} PROPERTIES INTERFACE_LINK_LIBRARIES ODBC::ClientAPI)
    endif ()
endif ()

if (USE_INTERNAL_SSL_LIBRARY)
    set (BUILD_SHARED 0)
    set (USE_SHARED 0)
    if (XCODE)
        set (ENABLE_ASM 0 CACHE INTERNAL "")
    endif ()
    add_subdirectory (ssl)
endif ()

if (USE_INTERNAL_POCO_LIBRARY)
    set (POCO_UNBUNDLED_ZLIB 1 CACHE INTERNAL "")
    if (WIN32)
        set (ENABLE_NETSSL_WIN 1 CACHE INTERNAL "")
    endif ()
    add_subdirectory (poco)
    if (OPENSSL_FOUND AND TARGET Crypto)
        # Bug in poco https://github.com/pocoproject/poco/pull/2100 found on macos
        target_include_directories(Crypto PUBLIC $<BUILD_INTERFACE:${OPENSSL_INCLUDE_DIR}>)
    endif ()
    if (USE_INTERNAL_POCO_LIBRARY)
        # Remove pthread from linking poco's Net
        set_property(TARGET Net PROPERTY INTERFACE_LINK_LIBRARIES "")
        set_property(TARGET Foundation PROPERTY INTERFACE_LINK_LIBRARIES "")
    endif ()
endif ()
